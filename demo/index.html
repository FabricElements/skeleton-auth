<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport"
        content="width=device-width, minimum-scale=1, maximum-scale=1, initial-scale=1, user-scalable=no">
  <title>skeleton-auth demo</title>

  <script src="../../webcomponentsjs/webcomponents-lite.js"></script>
  <script src="../../firebase/firebase.js"></script>
  <script src="../../firebase-config/index.js" async></script>

  <link rel="import" href="../../polymer/lib/elements/dom-bind.html">
  <link rel="import" href="../../polymer/lib/elements/custom-style.html">
  <link rel="import" href="../../polymer/lib/elements/dom-if.html">
  <link rel="import" href="../../paper-button/paper-button.html">
  <link rel="import" href="../../paper-input/paper-input.html">
  <link rel="import" href="../../paper-item/paper-item.html">
  <link rel="import" href="../../paper-item/paper-item-body.html">
  <link rel="import" href="../../paper-item/paper-icon-item.html">
  <link rel="import" href="../../iron-icons/iron-icons.html">
  <link rel="import" href="../../iron-icons/communication-icons.html">
  <link rel="import" href="../../iron-image/iron-image.html">

  <link rel="import" href="../skeleton-auth.html">

  <custom-style>
    <style is="custom-style">
      html,
      body {
        font-family: "Roboto", sans-serif;
        margin: 0;
        padding: 1rem;
        background: white;
      }

      paper-icon-item {
        --paper-item-icon-width: 50px;
      }

      paper-button {
        color: white;
        background-color: var(--paper-red-500);
        margin-top: 2rem;
      }

      #userBox {
        display: block;
      }

      iron-image {
        border-radius: 50%;
        height: 40px;
        width: 40px;
      }

      .container {
        margin: 0 auto;
        max-width: 500px;
        min-height: 100vh;
      }

      h3 {
        border-bottom: 1px solid var(--paper-grey-400);
        padding-bottom: 1rem;
        margin-bottom: 5rem;
      }

      skeleton-auth {
        --auth-button: {
          display: block;
          text-align: left;
          border-radius: 20px;
          margin: 1rem 0 0 0;
          padding: 10px 15px;
        };
      }
    </style>
  </custom-style>
</head>
<body>
<div class="container">
  <h3 class="paper-font-display1">Basic skeleton-auth demo</h3>
  <dom-bind>
    <template>
      <skeleton-auth google
                     facebook
                     twitter
                     github
                     anonymous
                     email
                     phone
                     popup
                     on-error="handleError"
                     hidden$="[[signedIn]]">
      </skeleton-auth>

      <dom-if if="[[signedIn]]">
        <template>
          <div id="userBox">
            <paper-icon-item>
              <iron-image placeholder="http://lorempixel.com/100/100"
                          sizing="cover" preload src$="[[user.photoURL]]" slot="item-icon"></iron-image>
              <paper-item-body>
                [[user.displayName]]
              </paper-item-body>
            </paper-icon-item>

            <paper-icon-item>
              <iron-icon icon="communication:email" slot="item-icon"></iron-icon>
              <paper-item-body>
                [[user.email]]
              </paper-item-body>
            </paper-icon-item>

            <paper-icon-item>
              <iron-icon icon="verified-user" slot="item-icon"></iron-icon>
              <paper-item-body>
                [[user.emailVerified]]
              </paper-item-body>
            </paper-icon-item>

            <paper-icon-item>
              <div slot="item-icon">uid</div>
              <paper-item-body>
                <div>[[user.uid]]</div>
              </paper-item-body>
            </paper-icon-item>

            <paper-input readonly label="token" id="token"></paper-input>

            <paper-button onclick="signOut()">Sign Out</paper-button>
            <paper-button onclick="getToken()">Get token</paper-button>
          </div>
          <script>
            /* eslint-disable no-unused-vars*/

            /**
             * Sign Out
             *
             * @private
             */
            function signOut() {
              const element = document.querySelector('skeleton-auth');
              element.signOut();
            }

            /**
             * jsonLog
             *
             * @param {Object} object
             * @private
             */
            function jsonLog(object) {
              console.log(object);
            }

            /**
             * Get Token
             *
             * @private
             */
            function getToken() {
              firebase.auth().currentUser.getIdToken(true).then(function(token) {
//            console.log('with ID token', token);
                const element = document.querySelector('#token');
                element.value = token;
              });
            }
          </script>
        </template>
      </dom-if>
    </template>
  </dom-bind>
</div>
</body>
</html>
